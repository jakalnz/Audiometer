#:kivy 1.9.1


###Tasks

###consider adding padding within grid to make buttons more separate allow bigger symbols

<AudioButton>
    id:default
    airconduction:airconduction
    sflayout:sflayout
    background_normal: ('')
    background_color: (0, 0, 0, 0) #a nice white background that hides my image
    text:"one"
    color:0,0,0,0 #made opacity 0 so cant interfere with grid lines may look to doing button behaviour

    size_hint:(1,1)
    on_press: self.changeImage() #WORKS!


    Image:

        id:airconduction
        source:'Icons/EMPTY.png'
        x: self.parent.center_x-1.5*self.parent.height/2
        y: self.parent.center_y-1.5*self.parent.height/2
        size:1.5*self.parent.height,1.5*self.parent.height
        #texture: makeTexture('RAC.png', 'LAC.png')
        mipmap: root.mipmap

    Image:
        id:sflayout
        x: self.parent.center_x-1.5*self.parent.height/2
        y: self.parent.center_y-1.5*self.parent.height/2
        size:1.5*self.parent.height,1.5*self.parent.height
        mipmap: root.mipmap
        source:'Icons/Empty.png'

<OctaveAudioButton@AudioButton>
    rightboneconduction:rightboneconduction
    leftboneconduction:leftboneconduction
    Image:
        id:rightboneconduction
        source:'Icons/EMPTY.png'
        x:self.parent.center_x-1.5*3*self.parent.height/2
        y:self.parent.center_y-1.5*self.parent.height/2
        size:1.5*self.parent.height,1.5*self.parent.height
        mipmap: root.mipmap

    Image:
        id:leftboneconduction
        source:'Icons/EMPTY.png'
        x:self.parent.center_x+1.5*self.parent.height/2
        y:self.parent.center_y-1.5*self.parent.height/2
        size:1.5*self.parent.height,1.5*self.parent.height
        mipmap: root.mipmap







<FrequencyColumn>

#draw grid onto canvas
    frequencyLabel:""
    canvas.before:
        Color:
            rgb: 1,1,1
        Rectangle
            pos:self.pos[0],self.pos[1]
            size:self.width,self.height-self.height/26

    canvas:

        Color:
            rgb: 0, 0, 0
        Rectangle:
            #pos: self.center_x - 1, (self.height/26)/2 - 0
            pos: self.center_x - 1, self.pos[1]+(self.height/26)/2
            size: 2, self.height - 4*(self.height/26)/2 - 0

        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+5*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+9*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+13*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+17*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+21*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+25*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+29*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+33*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+37*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+41*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+45*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+49*(self.height/26)/2 - 0
            size: self.width, 1

#    canvas.before:
#        Color:
#            rgb:1,1,1
#        Rectangle:
##            pos: self.pos
#            size: self.size
    frequencyLabel: "default"
    GridLayout:
        size:root.size
        pos:root.pos
        cols: 1
        Label:
            id:freq
            valign: 'bottom'

            text:root.frequencyLabel
            color:0,0,0,1
#            canvas.before:
#                Color:
#                    rgba: 1,1,1,1
#                Rectangle:
#                    pos:self.pos
#                    size: self.size
            #size_hint:(1,1)
#Place buttons
	    OctaveAudioButton:
            id: butn10
	        bLev: butn10
            text:"-10"
	    OctaveAudioButton:
	        id:butn5
	        bLev: butn5
	        text:"-5"
	    OctaveAudioButton:
	        id:but0
	        bLev: but0
	        text:"0"
	    OctaveAudioButton:
	        bLev: but5
            id: but5
            text:"5"
	    OctaveAudioButton:
	        bLev: but10
	        id:but10
	        text:"10"
	    OctaveAudioButton:
	        bLev: but15
	        id:but15
	        text:"15"
	    OctaveAudioButton:
	        bLev: but20
	        id:but20
	        text:"20"
        OctaveAudioButton:
	        bLev: but25
	        id:but25
	        text:"25"
	    OctaveAudioButton:
            bLev: but30
            id: but30
            text:"30"
	    OctaveAudioButton:
	        bLev: but35
	        id:but35
	        text:"35"
	    OctaveAudioButton:
	        bLev: but40
	        id:but40
	        text:"40"
	    OctaveAudioButton:
	        bLev: but45
	        id:but45
	        text:"45"
        OctaveAudioButton:
	        bLev: but50
	        id:but50
	        text:"50"
	    OctaveAudioButton:
            id:but55
            text:"55"
        OctaveAudioButton:
	        id:but60
	        text:"60"
	    OctaveAudioButton:
            id:but65
            text:"65"
        OctaveAudioButton:
	        id:but70
	        text:"70"
	    OctaveAudioButton:
            id:but75
            text:"75"
        OctaveAudioButton:
	        id:but80
	        text:"80"
	    OctaveAudioButton:
            id:but85
            text:"85"
        OctaveAudioButton:
	        id:but90
	        text:"90"
	    OctaveAudioButton:
            id:but95
            text:"95"
        OctaveAudioButton:
	        id:but100
	        text:"100"
	    OctaveAudioButton:
            id:but105
            text:"105"
        OctaveAudioButton:
	        id:but110
	        text:"110"

#Layout for Half Freq - removes 1pt blackline
<HalfFrequencyColumn>
    canvas.before:
        Color:
            rgb: 1,1,1
        Rectangle
            pos:self.pos[0],self.pos[1]
            size:self.width,self.height-self.height/26

    canvas:
        Color:
            rgb: 0, 0, 0
        Rectangle:
            pos: self.center_x - 1, self.pos[1]+(self.height/26)/2 - 0
            size: 1, self.height - 4*(self.height/26)/2 - 0

        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+5*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+9*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+13*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+17*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+21*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+25*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+29*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+33*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+37*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+41*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+45*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+49*(self.height/26)/2 - 0
            size: self.width, 1
            
    frequencyLabel: "default"
    GridLayout:
        size:root.size
        pos:root.pos
        cols: 1
        Label:
            id:freq
            valign: 'bottom'

            text:root.frequencyLabel
            color:0,0,0,1

	    AudioButton:
            id: butn10
	        bLev: butn10
            text:"-10"
	    AudioButton:
	        id:butn5
	        bLev: butn5
	        text:"-5"
	    AudioButton:
	        id:but0
	        bLev: but0
	        text:"0"
	    AudioButton:
	        bLev: but5
            id: but5
            text:"5"
	    AudioButton:
	        bLev: but10
	        id:but10
	        text:"10"
	    AudioButton:
	        bLev: but15
	        id:but15
	        text:"15"
	    AudioButton:
	        bLev: but20
	        id:but20
	        text:"20"
        AudioButton:
	        bLev: but25
	        id:but25
	        text:"25"
	    AudioButton:
            bLev: but30
            id: but30
            text:"30"
	    AudioButton:
	        bLev: but35
	        id:but35
	        text:"35"
	    AudioButton:
	        bLev: but40
	        id:but40
	        text:"40"
	    AudioButton:
	        bLev: but45
	        id:but45
	        text:"45"
        AudioButton:
	        bLev: but50
	        id:but50
	        text:"50"
	    AudioButton:
            id:but55
            text:"55"
        AudioButton:
	        id:but60
	        text:"60"
	    AudioButton:
            id:but65
            text:"65"
        AudioButton:
	        id:but70
	        text:"70"
	    AudioButton:
            id:but75
            text:"75"
        AudioButton:
	        id:but80
	        text:"80"
	    AudioButton:
            id:but85
            text:"85"
        AudioButton:
	        id:but90
	        text:"90"
	    AudioButton:
            id:but95
            text:"95"
        AudioButton:
	        id:but100
	        text:"100"
	    AudioButton:
            id:but105
            text:"105"
        AudioButton:
	        id:but110
	        text:"110"            


#Spacemaker for 333Hz so buttons not needed, may need to change so colours can be added to AG
#?Use @HalfFrequencyColumn instead or.... Replace Buttons with Labels or...
#@LevelColumn below which is a better fit!
<EmptyFrequencyColumn@Label>

    canvas.before:
        Color:
            rgb: 1,1,1
        Rectangle
            pos:self.pos[0],self.pos[1]
            size:self.width,self.height-self.height/26
    canvas:
        Color:
            rgb: 0, 0, 0


        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+5*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+9*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+13*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+17*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+21*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+25*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+29*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+33*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+37*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+41*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+45*(self.height/26)/2 - 0
            size: self.width, 1
        Rectangle:
            pos: self.center_x-0.5*self.width, self.pos[1]+49*(self.height/26)/2 - 0
            size: self.width, 1


#Extend the Label class to have multiple Lables for the Grid
<LevelColumn@Label>
    GridLayout:

        size: root.size
        pos: root.pos

        canvas.after:
            Color:
                rgb: 0, 0, 0
            Rectangle:
                pos: self.center_x + 0.5*self.width- 1, self.pos[1]+(self.height/26)/2 - 0
                size: 2, self.height - 4*(self.height/26)/2 - 0
	    cols: 1
        Label:
            text:""
            color:0,0,0,1
        Label:
            halign:"left"
            text:"-10"
            color:0,0,0,1

        Label:
            text:"-5"
            color:0,0,0,1
        Label:
            text:"0"
            color:0,0,0,1
        Label:
            text:"5"
            color:0,0,0,1
        Label:
            text:"10"
            color:0,0,0,1
        Label:
            text:"15"
            color:0,0,0,1
        Label:
            text:"20"
            color:0,0,0,1
        Label:
            text:"25"
            color:0,0,0,1
        Label:
            text:"30"
            color:0,0,0,1
        Label:
            text:"35"
            color:0,0,0,1
        Label:
            text:"40"
            color:0,0,0,1
        Label:
            text:"45"
            color:0,0,0,1
        Label:
            text:"50"
            color:0,0,0,1
        Label:
            text:"55"
            color:0,0,0,1
        Label:
            text:"60"
            color:0,0,0,1
        Label:
            text:"65"
            color:0,0,0,1
        Label:
            text:"70"
            color:0,0,0,1
        Label:
            text:"75"
            color:0,0,0,1
        Label:
            text:"80"
            color:0,0,0,1
        Label:
            text:"85"
            color:0,0,0,1
        Label:
            text:"90"
            color:0,0,0,1
        Label:
            text:"95"
            color:0,0,0,1
        Label:
            text:"100"
            color:0,0,0,1
        Label:
            text:"105"
            color:0,0,0,1
        Label:
            text:"110"
            color:0,0,0,1

#Puts all the columns together and make an audiogram widget
<AudiogramW>:
    audiogramW:audiogramW

    canvas.before:
        Color:
            rgb: 1,1,1
        Rectangle
            pos:self.pos[0],self.pos[1]
            size:self.size
    GridLayout:
        padding:0,10,0,10
        id:audiogramW
        size: root.size
        pos:root.pos
	    rows: 1
	    LevelColumn:
	        size_hint_x:0.4


        FrequencyColumn:
            id:c250
            frequencyLabel: "250"
        EmptyFrequencyColumn:
            size_hint_x:0.4
        FrequencyColumn:
            id:c500
            frequencyLabel: "500"
            #root.frequencyLabel:"500Hz"
        HalfFrequencyColumn:
            id:c750
            size_hint_x:0.4
            frequencyLabel: "750"
        FrequencyColumn:
            id:c1000
            frequencyLabel: "1000"
        HalfFrequencyColumn:
            id:c1500
            frequencyLabel: "1500"
            size_hint_x:0.4
        FrequencyColumn:
            id:c2000
            frequencyLabel: "2000"
        HalfFrequencyColumn:
            id:c3000
            frequencyLabel: "3000"
            size_hint_x:0.4
        FrequencyColumn:
            id:c4000
            frequencyLabel: "4000"
        HalfFrequencyColumn:
            id:c6000
            frequencyLabel: "6000"
            size_hint_x:0.4
        FrequencyColumn:
            id:c8000
            frequencyLabel: "8000"


<PatientDetails>:
    BoxLayout:
        id:details
        size:root.width, root.height/2
        pos:root.pos
        orientation:'vertical'




        GridLayout:
            id: demographics
            cols:4
            Label:
                size_hint_y:0.2
                size_hint_x:0.3
            Label:
                size_hint_y:0.2
                text:'First'
            Label:
                size_hint_y:0.2
                text:'Surname'

            Label:
                size_hint_x:0.3
                size_hint_y:0.2
            Label:
                text:'Name'
                size_hint_x:0.3

            TextInput:
                id:first_name
                write_tab: False
                multiline: False
                on_text: root.patientName[0] = self.text; root.addlabeltext()
            TextInput:
                id:surname
                height: self.minimum_height
                write_tab: False
                multiline: False
                on_text: root.patientName[1] = self.text; root.addlabeltext()
            Label:
                size_hint_x:0.3
            # DOB  LABEL
            Label:
                size_hint_x:0.3
                size_hint_y:0.2
            BoxLayout:
                size_hint_y:0.2
                Label:
                    text:'Day'
                    size_hint_x:0.2
                Label:
                    text:'Month'
                    size_hint_x:0.2
                Label:
                    text:'Year'
                    size_hint_x:0.6
            #GENDER LABEL
            BoxLayout:
                size_hint_y:0.2
                Label:
                Label:
                    text:'Male'
                    #size_hint_x:0.2
                Label:
                    text:'Female'
                    #size_hint_x:0.2
                Label:

            Label:
                size_hint_x:0.3
                size_hint_y:0.2
            # DOB INPUT
            Label:
                text:'D.O.B.:'
                size_hint_x:0.3
            BoxLayout:
                size_hint_y:0.2
                TextInput:
                    id:dob_day
                    size_hint_x:0.2
                    input_filter:'int'
                    write_tab: False
                    multiline: False
                    on_text: root.updatePatientDOB(dd = self.text); root.addlabeltext()#root.patientDOB[0] = '    D.O.B.: ' + self.text

                TextInput:
                    id:dob_month
                    size_hint_x:0.2
                    input_filter:'int'
                    write_tab: False
                    multiline: False
                    on_text:  root.updatePatientDOB(mm = self.text); root.addlabeltext()#root.patientDOB[1] = '/' + self.text
                TextInput:
                    id:dob_year
                    input_filter:'int'
                    size_hint_x:0.6
                    write_tab: False
                    multiline: False
                    on_text:  root.updatePatientDOB(yyyy = self.text); root.addlabeltext()#root.patientDOB[2] = '/' + self.text

            #GENDER INPUT
            BoxLayout:
                size_hint_y:0.2
                Label:
                    text:'Gender:'

                CheckBox:
                    id:chk_male
                    group:'gender'
                    on_active:root.patientSex = ' (M) '; root.addlabeltext()
                    #size_hint_x:0.2
                CheckBox:
                    id:chk_female
                    group:'gender'
                    on_active:root.patientSex = ' (F) '; root.addlabeltext()
                    #size_hint_x:0.2
                Label:
                    #size_hint_x:0.3
            Label:
                size_hint_x:0.3





        GridLayout:
            cols:3
            size_hint_y:0.9

            Label:
                size_hint_x:0.144
                text:'File#:'
            TextInput:
                id: file_number
                write_tab: False
                multiline: False
                on_text: root.patientFile = self.text; root.addlabeltext()
            Label:
                size_hint_x:0.12
            Label:
                size_hint_x:0.144
                text:'Email'
            TextInput:
                id:email
                write_tab: False
                multiline: False
            Label:
                size_hint_x:0.12





<Controller>:
    controlID:controlID
    controllerNR:controllerNR
    controllerNote:controllerNote
    transducer:transducer
    reliability:reliability
    test_type:test_type
    id:controlID
    BoxLayout:
        size:root.size
        pos:root.pos
        orientation:'vertical'

        Label:
            text:"Threshold Type"
            size_hint_y:.1
        GridLayout:

            cols:3
            Label:
                text:'SF'
            Label:
            Label:
                text:'Aided'
            ToggleButton:
                id:sf-
                group:type
                canvas.after:
                    Rectangle:
                        size:self.size
                        pos:self.pos
                        source:'Icons/SF.png'

                on_press:root.getControllerInput('sf-')
                mipmap: self.parent.parent.parent.mipmap
            Label:
            ToggleButton:
                id:ad-
                group:type
                canvas.after:
                    Rectangle:
                        size:self.size
                        pos:self.pos
                        source:'Icons/HA.png'
                on_press:root.getControllerInput('ha-')
                mipmap: self.parent.parent.parent.mipmap


            Label:
                text:'Right'

            Label:

            Label:
                text:'Left'

            ToggleButton
                id:ra-
                group:type
                on_press:root.getControllerInput('ra-')
                canvas.after:
                    Rectangle:
                        size:self.size
                        pos:self.pos
                        source:'Icons/RAC.png'
                mipmap: self.parent.parent.parent.mipmap

            Label:
                text_size: self.size
                halign: 'center'
                valign:'middle'
                text:'Air'

            ToggleButton
                id:la-
                mipmap: self.parent.parent.parent.mipmap
                group:type
                on_press:root.getControllerInput('la-')
                canvas.after:
                    Rectangle:
                        size:self.size
                        pos:self.pos
                        source:'Icons/LAC.png'

            ToggleButton
                id:ram
                group:type
                mipmap: self.parent.parent.parent.mipmap
                on_press:root.getControllerInput('ram')
                canvas.after:
                    Rectangle:
                        size:self.size
                        pos:self.pos
                        source:'Icons/M-RAC.png'

            Label:
                text_size: self.size
                halign: 'center'
                valign:'middle'
                font_size:10
                text:'Masked\nAir'

            ToggleButton
                id:lam
                group:type
                mipmap: self.parent.parent.parent.mipmap
                on_press:root.getControllerInput('lam')
                canvas.after:
                    Rectangle:
                        size:self.size
                        pos:self.pos
                        source:'Icons/M-LAC.png'

            ToggleButton
                id:rb-
                group:type
                mipmap: self.parent.parent.parent.mipmap
                on_press:root.getControllerInput('rb-')
                canvas.after:
                    Rectangle:
                        size:self.size
                        pos:self.pos
                        source:'Icons/RBC.png'

            Label:
                text:'Bone'
                text_size: self.size
                halign: 'center'
                valign:'middle'

            ToggleButton
                id:lb-
                group:type
                mipmap: self.parent.parent.parent.mipmap
                on_press:root.getControllerInput('lb-')
                canvas.after:
                    Rectangle:
                        size:self.size
                        pos:self.pos
                        source:'Icons/LBC.png'
            ToggleButton
                id:rbm
                group:type
                mipmap: self.parent.parent.parent.mipmap
                on_press:root.getControllerInput('rbm')
                canvas.after:
                    Rectangle:
                        size:self.size
                        pos:self.pos
                        source:'Icons/M-RBC.png'

            Label:
                text:'[size=10]Masked\nBone[/size]'
                text_size:self.size
                markup:'True'
                #font_size:
                halign: 'center'
                valign:'middle'
            ToggleButton
                id:lbm
                group:type
                mipmap: self.parent.parent.parent.mipmap
                on_press:root.getControllerInput('lbm')
                canvas.after:
                    Rectangle:
                        size:self.size
                        pos:self.pos
                        source:'Icons/M-LBC.png'


        Label:
            text:"Modifiers"
            size_hint_y:.1

        ToggleButton:
            id:controllerNR
            size_hint_y:.2
            text: "NR"
            on_state:root.getControllerNR(self.state)
        Spinner:
            # default value shown
            id:controllerNote
            size_hint_y:.2
            text:'No Note'
            values:['No Note','Note 1', 'Note 2', 'Note 3']
            on_text:root.getControllerNote(self.text)
        Label:
            text:"Transducer"
            size_hint_y:.1
        Spinner:
            id:transducer
            # default value shown
            size_hint_y:.2
            text:'Headphone'
            values:['Headphone','Insert', 'Soundfield']
        Label:
            text:"Reliability"
            size_hint_y:.1
        Spinner:
            id:reliability
            # default value shown
            size_hint_y:.2
            text:'Good'
            values:['Good','Fair', 'Poor']
        Label:
            text:'Test Type'
            size_hint_y:.1
        Spinner:
            id:test_type
            size_hint_y:.2
            text:'PTA'
            values:['PTA','CPA', 'VRA']

<SpeechInput>:
    id:'default'

    BoxLayout:
        size:root.size
        pos:root.pos
        GridLayout:
            cols:6

            Label:
                text:'Material'
            Label:
                text:'Type'
            Label:
                text:'Level \n(dBHL)'
            Label:
                text:'Score\n(%)'
            Label:
                text:'SNR'
            Label:
                text:'Masked'
            Spinner:
                text:'CVC'
                values:['CVC','MLV','Spondee', 'HINT']
            Spinner:
                text:'SRT'
                values:['SDT', 'SRT', 'WRT', 'MCL', 'UCL']
            TextInput:
                id:speech_level_1
            TextInput:
                id:speech_score_1
            TextInput:
                id:SNR
            CheckBox:
                id:masked_speech_1
            Spinner:
                text:'CVC'
                values:['CVC','MLV','Spondee', 'HINT']
            Spinner:
                text:'SRT'
                values:['SDT', 'SRT', 'WRT', 'MCL', 'UCL']
            TextInput:
                id:speech_level_2
            TextInput:
                id:speech_score_2
            TextInput:
                id:SNR
            CheckBox:
                id:masked_speech_2
            Spinner:
                text:'CVC'
                values:['CVC','MLV','Spondee', 'HINT']
            Spinner:
                text:'SRT'
                values:['SDT', 'SRT', 'WRT', 'MCL', 'UCL']
            TextInput:
                id:speech_level_3
            TextInput:
                id:speech_score_3
            TextInput:
                id:SNR
            CheckBox:
                id:masked_speech_3
            Spinner:
                text:'CVC'
                values:['CVC','MLV','Spondee', 'HINT']
            Spinner:
                text:'SRT'
                values:['SDT', 'SRT', 'WRT', 'MCL', 'UCL']
            TextInput:
                id:speech_level_4
            TextInput:
                id:speech_score_4
            TextInput:
                id:SNR
            CheckBox:
                id:masked_speech_4

<TympDrawCtrl>:

    BoxLayout:
        size:root.size
        pos:root.pos
        ToggleButton:
            text:'Draw Right'
            group:'l-r-sel'
            on_press:root.selectedTymp ='right'
        ToggleButton:
            text:'Draw Left'
            group:'l-r-sel'
            on_press:root.selectedTymp = 'left'
        Button:
            text:'Clear Selected'
            on_press:root.parent.parent.ids.tympDrawID.clearLine()

<TympDraw>:
    id:default

    canvas.before:
        Rectangle:
            size:self.size
            pos:self.pos
            source:'Images/reflexes/TympCanvas.png'

<TympInput>:

    tympInputID: tympInputID
    tympDrawCtrlID:tympDrawCtrlID
    tympDrawID:tympDrawID
    id:tympInputID
    BoxLayout:
        size:root.size
        pos:root.pos
        orientation:'vertical'
        TympDraw:
            id:tympDrawID
        TympDrawCtrl:
            id:tympDrawCtrlID
            size_hint:(1,0.1)
        GridLayout:
            cols:3
            row_default_height:30
            Label:
                text:'Right'

            Label:
                text:''
            Label:
                text:'Left'
            BoxLayout:
                size:root.size
                pos:root.pos
                Spinner:
                    id:r-type
                    text:'DNT'
                    values:'A','B','C','CNT','DNT'
                Spinner:
                    id:r-mod
                    text:''
                    values:'','deep','shallow','high','low'
            Label:
                text:'Type'
            BoxLayout:
                size:root.size
                pos:root.pos
                Spinner:
                    id:l-type
                    text:'DNT'
                    values:'A','B','C','CNT','DNT'
                Spinner:
                    id:l-mod
                    text:''
                    values:'','deep','shallow','high','low'
            TextInput:
                id:r-MEP
            Label:
                text:'MEP\ndaPa'
            TextInput:
                id:l-MEP
            TextInput:
                id:r-Adm
            Label:
                text:'Com.\nml'
            TextInput:
                id:l-Adm
            TextInput:
                id:r-Vol
            Label:
                text:'Vol\nml'
            TextInput:
                id:l-Vol
            TextInput:
                id:r-Width
            Label:
                text:'Width\ndaPa'
            TextInput:
                id:l-Width



<ReflexType>:
    #dropDownID:dropDownID
    Button:
        id:present
        text:'present'
        size_hint_y:None
        height: '48dp'
        on_release: root.select('Images/reflexes/Present.png')
        canvas.after:
            Rectangle:
                source:'Images/reflexes/Present_x.png'
                size:self.size
                pos:self.pos
    Button:
        id:elevated
        text:'elevated'
        size_hint_y:None
        height: '48dp'
        on_release: root.select('Images/reflexes/Elevated.png')
        canvas.after:
            Rectangle:
                source:'Images/reflexes/Elevated_x.png'
                size:self.size
                pos:self.pos
    Button:
        id:absent
        text:'absent'
        size_hint_y:None
        height: '48dp'
        on_release: root.select('Images/reflexes/Absent.png')
        canvas.after:
            Rectangle:
                source:'Images/reflexes/Absent_x.png'
                size:self.size
                pos:self.pos
    Button:
        id:abnormal
        text:'abnormal'
        size_hint_y:None
        height: '48dp'
        on_release: root.select('Images/reflexes/Abnormal.png')
        canvas.after:
            Rectangle:
                source:'Images/reflexes/Abnormal_x.png'
                size:self.size
                pos:self.pos
    Button:
        id:CNT
        text:'CNT'
        size_hint_y:None
        height: '48dp'
        on_release: root.select('Images/reflexes/CNT.png')
        canvas.after:
            Rectangle:
                source:'Images/reflexes/CNT_x.png'
                size:self.size
                pos:self.pos
    Button:
        id:DNT
        text:'DNT'
        size_hint_y:None
        height: '48dp'
        on_release: root.select('Images/reflexes/DNT.png')
        canvas.after:
            Rectangle:
                source:'Images/reflexes/DNT_x.png'
                size:self.size
                pos:self.pos
    Button:
        id:Blank
        text:'Blank'
        size_hint_y:None
        height: '48dp'
        on_release: root.select('Images/reflexes/Blank.png')
        canvas.after:
            Rectangle:
                source:'Images/reflexes/Blank_x.png'
                size:self.size
                pos:self.pos


<ReflexInputR>:
    id:default

    BoxLayout:
        orientation:'vertical'
        size:root.size
        pos:root.pos
        GridLayout:
            cols:3
            #row_default_height:20
            Label:
                text:'0.5kHz'
                color:[0,0,0,1]
                canvas.before:
                    Color:
                        rgba: 1, 1, 1, 1 # your color here
                    Rectangle:
                        pos: self.pos
                        size: self.size

            TextInput:
                height:self.minimum_height
                multiline:False
                write_tab: False
                font_size:11

            ReBut:
            Label:
                text:'1kHz'
                color:[0,0,0,1]
                canvas.before:
                    Color:
                        rgba: 1, 1, 1, 1 # your color here
                    Rectangle:
                        pos: self.pos
                        size: self.size
            TextInput:
                multiline:False
                write_tab: False
                font_size:11

            ReBut:
            Label:
                text:'2kHz'
                color:[0,0,0,1]
                canvas.before:
                    Color:
                        rgba: 1, 1, 1, 1# your color here
                    Rectangle:
                        pos: self.pos
                        size: self.size
            TextInput:
                multiline:False
                write_tab: False
                font_size:11

            ReBut:
            Label:
                text:'BBN'
                color:[0,0,0,1]
                canvas.before:
                    Color:
                        rgba: 1, 1, 1, 1 # your color here
                    Rectangle:
                        pos: self.pos
                        size: self.size
            TextInput:
                multiline:False
                write_tab: False
                font_size:11
            ReBut:

<ReflexInputL>:
    id:default
    BoxLayout:
        orientation:'vertical'
        size:root.size
        pos:root.pos
        GridLayout:
            cols:3
            #row_default_height:25
            ReBut:
            TextInput:
                multiline:False
                write_tab: False
                font_size:11

            Label:
                text:'0.5kHz'
                color:[0,0,0,1]
                canvas.before:
                    Color:
                        rgba: 1, 1, 1, 1  # your color here
                    Rectangle:
                        pos: self.pos
                        size: self.size
            ReBut:
            TextInput:
                multiline:False
                write_tab: False
                font_size:11

            Label:
                text:'1kHz'
                color:[0,0,0,1]
                canvas.before:
                    Color:
                        rgba: 1, 1, 1, 1 # your color here
                    Rectangle:
                        pos: self.pos
                        size: self.size
            ReBut:
            TextInput:
                multiline:False
                write_tab: False
                font_size:11

            Label:
                text:'2kHz'
                color:[0,0,0,1]
                canvas.before:
                    Color:
                        rgba: 1, 1, 1, 1 # your color here
                    Rectangle:
                        pos: self.pos
                        size: self.size
            ReBut:
            TextInput:
                multiline:False
                write_tab: False
                font_size:11
            Label:
                text:'BBN'
                color:[0,0,0,1]
                canvas.before:
                    Color:
                        rgba: 1, 1, 1, 1# your color here
                    Rectangle:
                        pos: self.pos
                        size: self.size
ScreenManager:
    id:sm
    PatientScreen:
        id:patient_screen
        name:'patient'
    AudioScreen:
        id:audio_screen
        name:'audio'
    SpeechScreen:
        id:speech_screen
        name:'speech'
    ImmittanceScreen:
        id:immittance_screen
        name:'immittance'
    ReportScreen:
        id:report_screen
        name:'report'



<NavigationBar>:
    pos_hint: {'top':1}
    #
    ActionView:
        ActionPrevious:
        ActionButton:
            text:'Patient'
            on_press:root.parent.parent.manager.current = 'patient'
        ActionButton:
            text:'Audiogram'
            on_press:root.parent.parent.manager.current = 'audio'
        ActionButton:
            text:'Speech'
            #on_press:root.parent.parent.manager.current = 'speech'
            on_press:root.goToSpeechScreen()
        ActionButton:
            text:'Immittance'
            on_press:root.parent.parent.manager.current = 'immittance'
        ActionButton:
            text:'Report'
            on_press:root.parent.parent.manager.current = 'report'



<PatientScreen>:
    id:info

    #size:root.size #is this needed
    patientInput:patientInput
    BoxLayout:
        #size:root.size
        orientation:'vertical'

        NavigationBar:
            size_hint: (1., 0.1)
        PatientDetails:
            id:patientInput


<AudioScreen>:
    #size:root.size  #is this needed
    id:audio
    current_audiogram:current_audiogram
    drawlineDrawer:drawlineDrawer
    patientLabel:patientLabel
    currentAudioChart:currentAudioChart
    control:control

    BoxLayout:
        id:current_audiogram
        size:root.size
        orientation:'vertical'

        NavigationBar:
            size_hint: (1., 0.1)
        Label:
            id:patientLabel
            size_hint:(1.,0.1)
            valign: 'middle'
            halign:'left'
            text_size: self.size
            text: ''#root.update_patient_label()
        GridLayout:
            #size:root.size
            #pos:root.pos
            rows:1

            AudiogramW:
                id:currentAudioChart

            Accordion:
                size_hint_x:.25
                orientation:'vertical'


                AccordionItem:
                    id:drawlineDrawer
                    title:'Mark Lines'

                    BoxLayout:
                        orientation:'vertical'
                        ToggleButton
                            id:redline
                            group:'draw'
                            on_press:root.getLineType('right')
                            text:'red line'

                        ToggleButton
                            id:blueline
                            group:'draw'
                            on_press:root.getLineType('left')
                            text:'blue line'

                        Button
                            id:clearred
                            text: 'Clear Red Line'
                            on_press: root.clearRedLine()

                        Button
                            id:clearblue
                            text: 'Clear Blue Line'
                            on_press: root.clearBlueLine() # method that clears the blue lines
                AccordionItem:
                    title:'Draw Symbols'
                    Controller:
                        id:control
        GridLayout:
            size_hint_y:.1
            pos:root.pos
            rows:1
            TextInput:
                text:"Comments and Notes:"

<SpeechScreen>:
    speechAudioID:speechAudioID
    #speechAudioImage:speechAudioImage
    BoxLayout:
        orientation:'vertical'
        NavigationBar:
            size_hint: (1., 0.1)
        GridLayout:
            cols:2

            Image:
                id:speechAudioID
                #size_hint: 1,1
                pos: self.parent.parent.pos
                source: root.speechAudioImage
                allow_stretch:True
                keep_ratio:False
            Label:
                text:'Speech Graph here'
            Label:

                canvas.before:
                    Color:
                        rgb: 1, 0, 0 # your color here
                    Rectangle:
                        pos: self.pos
                        size: self.size

                text:'Speech Right'
                size_hint_y:0.1
            Label:
                canvas.before:
                    Color:
                        rgb: 0, 0, 1 # your color here
                    Rectangle:
                        pos: self.pos
                        size: self.size
                text:'Speech Left'
                size_hint_y:0.1
            SpeechInput:
                id:right

            SpeechInput:
                id:left



<ImmittanceScreen>:
    tympImage:tympImage
    #tympData:tympData
    reflexImage:reflexImage
    BoxLayout:
        orientation:'vertical'

        NavigationBar:
            size_hint: (1., 0.1)
        GridLayout:
            cols:2
            spacing:30
            Label:
                text:'\nTympanometry'
                size_hint:(0.8,0.02)
            Label:
                text:'\nAcoustic Reflexes'
                size_hint:(1.0,0.02)
            TympInput:
                id:tympImage
                size_hint_x:0.8
                #tympInput:tympInput
                #id:tympInput
            BoxLayout:
                orientation:'vertical'
                size_hint:(1.0,1.0)
                BoxLayout:
                    id:reflexImage
                    orientation:'vertical'
                    size_hint:(1.0,0.36)
                    GridLayout:
                        cols:3
                        Label:
                            color:[0,0,0,1]
                            text:'Sound Right'
                            size_hint: (1., 0.15)
                            canvas.before:
                                Color:
                                    rgba: 1, 1, 1,1# your color here
                                Rectangle:
                                    pos: self.pos
                                    size: self.size
                        Label:
                            size_hint: (1., 0.15)
                            color:[0,0,0,1]
                            text:'Contra-lateral'
                            canvas.before:
                                Color:
                                    rgb: 1, 1, 1 # your color here
                                Rectangle:
                                    pos: self.pos
                                    size: self.size
                        Label:
                            text:'Sound Left'
                            color:[0,0,0,1]
                            size_hint: (1., 0.15)
                            canvas.before:
                                Color:
                                    rgba: 1, 1, 1,1 # your color here
                                Rectangle:
                                    pos: self.pos
                                    size: self.size
                        ReflexInputR:
                        Label:
                            size_hint: (1., 0.1)
                            canvas.before:
                                Rectangle:
                                    size:self.size

                                    pos:self.pos
                                    source:'Images/reflexes/Contra.png'
                        ReflexInputL:

                    GridLayout:
                        cols:3
                        Label:
                            text:''
                            size_hint: (1., 0.15)
                            canvas.before:
                                Color:
                                    rgba: 1, 1, 1,1 # your color here
                                Rectangle:
                                    pos: self.pos
                                    size: self.size
                        Label:
                            size_hint: (1., 0.15)
                            color:[0,0,0,1]
                            text:'Ipsi-lateral'

                            canvas.before:
                                Color:
                                    rgb: 1, 1, 1 # your color here
                                Rectangle:
                                    pos: self.pos
                                    size: self.size
                        Label:
                            text:''
                            size_hint: (1., 0.15)
                            canvas.before:
                                Color:
                                    rgba: 1, 1, 1,1 # your color here
                                Rectangle:
                                    pos: self.pos
                                    size: self.size
                        ReflexInputR:

                        Label:
                            size_hint: (1., 0.1)
                            canvas.before:
                                Rectangle:
                                    size:self.size
                                    pos:self.pos
                                    source:'Images/reflexes/Ipsi.png'
                        ReflexInputL:
                    Image:
                        source:'Images/reflexes/reflexKey.png'
                        size_hint:(1., 0.2)
                        keep_ratio:False
                        allow_stretch:True

                Label:
                    size_hint:(1.0,0.02)
                    canvas.before:
                        Color:
                            rgba: 0, 0, 0,1 # your color here
                        Rectangle:
                            size:self.size
                            pos:self.pos

                TextInput:
                    size_hint:(1.0,0.2)
                    text:'Acoustic Reflex Comments:'
                TextInput:
                    size_hint:(1.0,0.2)
                    text:'Otoscopy Comments:'


<ReportScreen>:
    BoxLayout:
        orientation:'vertical'
        id:ReportMaker
        NavigationBar:
            size_hint: (1., 0.1)

        Button:
            id:print_audiogram_btn
            text:'Save Audiogram as PNG'
            on_press:root.save_audiogram()

        Button:
            id:makePDF
            text:'PDF Report'
            on_press:root.makeAudiogramReportPDF()

